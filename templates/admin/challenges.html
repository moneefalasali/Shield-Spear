{% extends 'base.html' %}

{% block title %}Manage Challenges - Admin{% endblock %}

{% block content %}
<div class="container" style="padding-top: 2rem;">
    <h1 class="page-title">Manage Challenges</h1>
    
    <div style="text-align: center; margin-bottom: 2rem;">
        <a href="{{ url_for('admin.add_challenge') }}" class="btn btn-primary">Add New Challenge</a>
        <a href="{{ url_for('admin.dashboard') }}" class="btn btn-outline">Back to Dashboard</a>
    </div>
    
    <div class="gradient-card">
        <table>
            <thead>
                <tr>
                    <th>Title</th>
                    <th>Category</th>
                    <th>Difficulty</th>
                    <th>Type</th>
                    <th>Status</th>
                    <th>Actions</th>
                </tr>
            </thead>
            <tbody>
                {% for challenge in challenges %}
                <tr>
                    <td><strong>{{ challenge.title }}</strong></td>
                    <td>{{ challenge.category|title }}</td>
                    <td>{{ challenge.difficulty|title }}</td>
                    <td>{{ challenge.challenge_type }}</td>
                    <td>
                        {% if challenge.is_active %}
                            <span style="color: #4CAF50;">✓ Active</span>
                        {% else %}
                            <span style="color: #ff6b6b;">✗ Inactive</span>
                        {% endif %}
                    </td>
                    <td>
                        <a href="{{ url_for('admin.edit_challenge', challenge_id=challenge.id) }}" class="btn btn-outline" style="padding: 0.25rem 0.75rem; font-size: 0.85rem;">Edit</a>
                        <button onclick="deleteChallenge('{{ challenge.id }}')"
 class="btn btn-outline" style="padding: 0.25rem 0.75rem; font-size: 0.85rem; border-color: #ff6b6b; color: #ff6b6b;">Delete</button>
                    </td>
                </tr>
                {% endfor %}
            </tbody>
        </table>
    </div>
</div>

{% block extra_js %}
<script>
function deleteChallenge(challengeId) {
    if (!confirm('Are you sure you want to delete this challenge?')) {
        return;
    }
    
    fetch(`/admin/challenges/${challengeId}/delete`, {
        method: 'POST',
        headers: {'Content-Type': 'application/json'}
    })
    .then(response => response.json())
    .then(data => {
        if (data.success) {
            alert('Challenge deleted successfully!');
            location.reload();
        } else {
            alert('Error: ' + (data.error || 'Unknown error'));
        }
    })
    .catch(error => {
        console.error('Error:', error);
        alert('Failed to delete challenge');
    });
}
</script>
{% endblock %}
{% endblock %}
